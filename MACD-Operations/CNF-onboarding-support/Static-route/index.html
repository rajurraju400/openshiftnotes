
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for OpenShift installation, backup, storage, troubleshooting, and more.">
      
      
        <meta name="author" content="venkatapathirajr">
      
      
      
        <link rel="prev" href="../createlabelpostinstall/">
      
      
        <link rel="next" href="../ocp_rbac_option1_with_sync/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>OCP route ingress and egress - OpenShift Notes</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.2afb09e1.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Red+Hat+Text:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Red Hat Text";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/redhat-style.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#creating-routes-on-ncp-egress-and-backward-routes" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="OpenShift Notes" class="md-header__button md-logo" aria-label="OpenShift Notes" data-md-component="logo">
      
  <img src="../../../images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OpenShift Notes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              OCP route ingress and egress
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="OpenShift Notes" class="md-nav__button md-logo" aria-label="OpenShift Notes" data-md-component="logo">
      
  <img src="../../../images/logo.png" alt="logo">

    </a>
    OpenShift Notes
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Git Helper
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Git Helper
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../git-helper/ncd-git-backup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Git Backup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../git-helper/ncd-git-restore/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Git Restore
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Deployment Scripts
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Deployment Scripts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../git-helper/Deployment/backupconfig.sh" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Backup Config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../git-helper/Deployment/newgitserver.sh" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    New Git Server (v1)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../git-helper/Deployment/git-server-deployment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GIT deployment
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    OpenShift
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            OpenShift
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Project Management
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Project Management
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/projectmanagement/scope/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Scope of work
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Deployment
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Deployment
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/deployment/automation/nokia-site-config-fixes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Nokia Automation Tool
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    User Management
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            User Management
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/usermanagement/remove-kubeadmin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Remove Kubeadmin
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/usermanagement/user-management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    User Management
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Backup & Restore
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Backup & Restore
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/backup-restore/ACM-GEO-RED/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ACM GEO Red
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/backup-restore/ACM-localbackup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ACM Local Backup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/backup-restore/AWS-S3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWS S3 Backup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/backup-restore/etcd-backup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ETCD Backup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/backup-restore/etcd-restore/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ETCD Restore
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Intergrations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            Intergrations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/Intergration/syslog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Clusterlogging
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Maintenance
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            Maintenance
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/maintenace/cluster-stop-start/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cluster Stop/Start
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/maintenace/reboot-nodes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reboot Nodes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/maintenace/openshift_scalein_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NMC/NWC Scale-In Nodes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/maintenace/openshift_scaleout_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NMC/NWC Scale-Out Nodes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" >
        
          
          <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Networking
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            Networking
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/networking/metalb-troubleshooting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MetalLB Troubleshooting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/networking/metallb-configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MetalLB Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_8" >
        
          
          <label class="md-nav__link" for="__nav_3_8" id="__nav_3_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Storage Management
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_8">
            <span class="md-nav__icon md-icon"></span>
            Storage Management
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/storagemanagement/ceph-rebalanceissue/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ceph Rebalance Issue
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/storagemanagement/storage-node-replacement/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Storage Node Replacement
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/storagemanagement/one-OSD-not-created/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ceph OSD recreate
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_9" >
        
          
          <label class="md-nav__link" for="__nav_3_9" id="__nav_3_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Troubleshooting
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_9">
            <span class="md-nav__icon md-icon"></span>
            Troubleshooting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/troubleshooting/nsenter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Nsenter Usage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/troubleshooting/ncomsa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NCOM Caas Issue
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_10" >
        
          
          <label class="md-nav__link" for="__nav_3_10" id="__nav_3_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Disaster Management
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_10">
            <span class="md-nav__icon md-icon"></span>
            Disaster Management
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/disaster-management/infra-manager-redeployment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Infra-Manager node reinstallation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../openshift/disaster-management/hub-cluster-redeployment/master-replacment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hub Cluster Master-replacement
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    MACD Operations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            MACD Operations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    MACD Management
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            MACD Management
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../MACD-management/scope/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Scope of work
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" checked>
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    CNF Onboarding Support
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            CNF Onboarding Support
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../image-tls-issue/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Image TLS Issue
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../oclogin-tls-issue/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OCLogin TLS Issue
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../proxy-cache-pod/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Proxy Cache Pod
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rolebinding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Role Allocation for CNF user
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Failtoconfigure_nncp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Failed to configure or Degraded
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kubeconfig/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kubeconfig overlapping
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../NCP-default-usersandrole/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NCP Standard user and role Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ts-tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cluster Wide TS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../istio-for-cnf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Istio for CNF
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../restrict-project-creation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Removing Self-Provisioner Access
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configure_openshift_tenable/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Nessus Security Access
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../createlabelpostinstall/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Creating labels post installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    OCP route ingress and egress
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    OCP route ingress and egress
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#before-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Before Implementation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#route-creation-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Route Creation Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ingress" class="md-nav__link">
    <span class="md-ellipsis">
      Ingress
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ingress">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ingress-explanation" class="md-nav__link">
    <span class="md-ellipsis">
      Ingress Explanation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ingress-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      Ingress Diagram
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ingress-config-example" class="md-nav__link">
    <span class="md-ellipsis">
      Ingress Config Example
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ingress Config Example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ingress-ipaddresspool-config" class="md-nav__link">
    <span class="md-ellipsis">
      Ingress IPAddresspool Config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ingress-backwards-route-config" class="md-nav__link">
    <span class="md-ellipsis">
      Ingress backward's route config
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#egress" class="md-nav__link">
    <span class="md-ellipsis">
      Egress
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Egress">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#egress-explanation" class="md-nav__link">
    <span class="md-ellipsis">
      Egress Explanation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#egress-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      Egress Diagram
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#egress-config-example" class="md-nav__link">
    <span class="md-ellipsis">
      Egress Config Example
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Egress Config Example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#egress-default-route" class="md-nav__link">
    <span class="md-ellipsis">
      Egress default route
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#egress-ip-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Egress IP configuration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Implementation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepare-the-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Prepare the configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#push-policy-to-git" class="md-nav__link">
    <span class="md-ellipsis">
      Push Policy to Git
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#apply-the-policies-now-using-cgu" class="md-nav__link">
    <span class="md-ellipsis">
      Apply the policies now using cgu
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ocp_rbac_option1_with_sync/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LDAP Intergration
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    CNF Onboarding Prerequisites
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            CNF Onboarding Prerequisites
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CNF-onboarding-prerequisites/NCOM.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NCOM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CNF-onboarding-prerequisites/NCD.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NCD
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CNF-onboarding-prerequisites/NCC/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NCC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CNF-onboarding-prerequisites/CMG.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CMG
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#before-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Before Implementation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#route-creation-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Route Creation Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ingress" class="md-nav__link">
    <span class="md-ellipsis">
      Ingress
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ingress">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ingress-explanation" class="md-nav__link">
    <span class="md-ellipsis">
      Ingress Explanation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ingress-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      Ingress Diagram
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ingress-config-example" class="md-nav__link">
    <span class="md-ellipsis">
      Ingress Config Example
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ingress Config Example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ingress-ipaddresspool-config" class="md-nav__link">
    <span class="md-ellipsis">
      Ingress IPAddresspool Config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ingress-backwards-route-config" class="md-nav__link">
    <span class="md-ellipsis">
      Ingress backward's route config
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#egress" class="md-nav__link">
    <span class="md-ellipsis">
      Egress
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Egress">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#egress-explanation" class="md-nav__link">
    <span class="md-ellipsis">
      Egress Explanation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#egress-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      Egress Diagram
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#egress-config-example" class="md-nav__link">
    <span class="md-ellipsis">
      Egress Config Example
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Egress Config Example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#egress-default-route" class="md-nav__link">
    <span class="md-ellipsis">
      Egress default route
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#egress-ip-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Egress IP configuration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Implementation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepare-the-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Prepare the configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#push-policy-to-git" class="md-nav__link">
    <span class="md-ellipsis">
      Push Policy to Git
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#apply-the-policies-now-using-cgu" class="md-nav__link">
    <span class="md-ellipsis">
      Apply the policies now using cgu
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="creating-routes-on-ncp-egress-and-backward-routes">Creating Routes on NCP (Egress and Backward Routes)<a class="headerlink" href="#creating-routes-on-ncp-egress-and-backward-routes" title="Permanent link">&para;</a></h1>
<blockquote>
<p>This guide explains how to configure routes for <strong>egress</strong> and <strong>ingress</strong> requirements using <strong>NNCP</strong>.</p>
</blockquote>
<hr />
<h2 id="before-implementation">Before Implementation<a class="headerlink" href="#before-implementation" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p>Changes involving MetalLB, IPAddressPool, backward routes, default egress routes, EgressIP configuration, and MetalLB loopback route modifications must be reviewed and agreed upon collaboratively by the solution architect, network architect, and cloud architect.</p>
</li>
<li>
<p>On the Nokia side, design documents such as IPCIQ, IPLLD, or DNP must be updated by their respective owners.</p>
</li>
<li>
<p>Based on the updated Nokia documents, the cloud architect should update the Cloud NCP LLD to reflect all new changes.</p>
</li>
<li>
<p>Once the above steps are complete, the MACD engineer can accept the ticket and review the LLD to fully understand the requirements.</p>
</li>
<li>
<p>Validate in the system whether the change has already been implemented to avoid duplicate route creation.</p>
</li>
<li>
<p>After all validations are completed, proceed with the implementation.</p>
</li>
<li>
<p>Most important point here is all change need to created via manifest file and updated respective PGT. push everything on git and sync argocd. at last push this config via CGU. (done via ZTP only). </p>
</li>
</ul>
<hr />
<h2 id="route-creation-overview">Route Creation Overview<a class="headerlink" href="#route-creation-overview" title="Permanent link">&para;</a></h2>
<p>All static routes are created on the <strong>gateway (GW) nodes</strong> to handle
both:</p>
<ul>
<li>
<p><strong>Ingress (backward routes):</strong> for incoming traffic</p>
</li>
<li>
<p><strong>Egress (default egress routes):</strong> for outgoing traffic</p>
</li>
</ul>
<hr />
<h2 id="ingress">Ingress<a class="headerlink" href="#ingress" title="Permanent link">&para;</a></h2>
<p>Ingress traffic is managed through <strong>MetalLB</strong>. Applications expose services with a <strong>LoadBalancer IP</strong>, which must be part of the MetalLB
configuration (<code>IPAddressPool</code>).</p>
<ul>
<li>MetalLB configuration is located at:<div class="codehilite"><pre><span></span><code>CWL-Cluster/site-policies/sites/hub/source-crs/metallb
</code></pre></div>

</li>
</ul>
<h3 id="ingress-explanation">Ingress Explanation<a class="headerlink" href="#ingress-explanation" title="Permanent link">&para;</a></h3>
<p>1) MetalLB speaker pods advertise the <strong>application LoadBalancer IP</strong> to BGP peers.</p>
<p>2)  BGP peers (on the switches) receive traffic destined for that IP.</p>
<p>3)  The traffic is routed to the MetalLB speaker pod.</p>
<p>4)  From there, Kubernetes iptables forwards it to the internal service cluster IP.</p>
<p>5)  Finally, traffic is directed to the appropriate application pod endpoint.</p>
<p>Since speaker pods run on <strong>GW nodes</strong>, the GW nodes must have routes to external client systems via the <strong>MetalLB VLAN interface</strong> (BGP subnet).</p>
<p>In OCP, these ingress routes are called <strong>backward routes</strong> and are
defined under:</p>
<div class="codehilite"><pre><span></span><code>CWL-Cluster/site-policies/sites/hub/source-crs/nmstate
</code></pre></div>

<h3 id="ingress-diagram">Ingress Diagram<a class="headerlink" href="#ingress-diagram" title="Permanent link">&para;</a></h3>
<p><img alt="alt text" src="../image-7.png" /></p>
<h3 id="ingress-config-example">Ingress Config Example<a class="headerlink" href="#ingress-config-example" title="Permanent link">&para;</a></h3>
<h4 id="ingress-ipaddresspool-config">Ingress IPAddresspool Config<a class="headerlink" href="#ingress-ipaddresspool-config" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code><span class="n">apiVersion</span><span class="o">:</span><span class="w"> </span><span class="n">metallb</span><span class="o">.</span><span class="na">io</span><span class="o">/</span><span class="n">v1beta1</span>
<span class="n">kind</span><span class="o">:</span><span class="w"> </span><span class="n">IPAddressPool</span>
<span class="n">metadata</span><span class="o">:</span>
<span class="w">  </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="n">ncp</span><span class="o">-</span><span class="n">metallb</span><span class="o">-</span><span class="n">oam</span><span class="o">-</span><span class="n">pa</span><span class="o">-</span><span class="n">pa</span><span class="o">-</span><span class="n">addresspool</span>
<span class="w">  </span><span class="kd">namespace</span><span class="o">:</span><span class="w"> </span><span class="n">metallb</span><span class="o">-</span><span class="n">system</span>
<span class="n">spec</span><span class="o">:</span>
<span class="w">  </span><span class="n">addresses</span><span class="o">:</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="mf">10.89</span><span class="o">.</span><span class="mf">101.128</span><span class="o">/</span><span class="mi">27</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="mf">10.89</span><span class="o">.</span><span class="mf">97.208</span><span class="o">/</span><span class="mi">28</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="mf">10.89</span><span class="o">.</span><span class="mf">99.192</span><span class="o">/</span><span class="mi">27</span>
<span class="w">  </span><span class="n">autoAssign</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">  </span><span class="n">avoidBuggyIPs</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span>
</code></pre></div>

<h4 id="ingress-backwards-route-config">Ingress backward's route config<a class="headerlink" href="#ingress-backwards-route-config" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code><span class="n">apiVersion</span><span class="o">:</span><span class="w"> </span><span class="n">nmstate</span><span class="o">.</span><span class="na">io</span><span class="o">/</span><span class="n">v1</span>
<span class="n">kind</span><span class="o">:</span><span class="w"> </span><span class="n">NodeNetworkConfigurationPolicy</span>
<span class="n">metadata</span><span class="o">:</span>
<span class="w">  </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="n">backward</span><span class="o">-</span><span class="n">route</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">oam</span><span class="o">-</span><span class="n">pa</span><span class="o">-</span><span class="n">pa</span><span class="o">-</span><span class="n">metallb</span><span class="o">-</span><span class="n">vlan104</span>
<span class="n">spec</span><span class="o">:</span>
<span class="w">  </span><span class="n">desiredState</span><span class="o">:</span>
<span class="w">    </span><span class="n">routes</span><span class="o">:</span>
<span class="w">      </span><span class="n">config</span><span class="o">:</span>
<span class="w">      </span><span class="o">-</span><span class="w"> </span><span class="n">destination</span><span class="o">:</span><span class="w"> </span><span class="mf">10.89</span><span class="o">.</span><span class="mf">100.66</span><span class="o">/</span><span class="mi">32</span>
<span class="w">        </span><span class="n">metric</span><span class="o">:</span><span class="w"> </span><span class="mi">150</span>
<span class="w">        </span><span class="n">next</span><span class="o">-</span><span class="n">hop</span><span class="o">-</span><span class="n">address</span><span class="o">:</span><span class="w"> </span><span class="mf">10.89</span><span class="o">.</span><span class="mf">97.161</span>
<span class="w">        </span><span class="n">next</span><span class="o">-</span><span class="n">hop</span><span class="o">-</span><span class="kd">interface</span><span class="o">:</span><span class="w"> </span><span class="n">vlan104</span>
<span class="w">        </span><span class="n">table</span><span class="o">-</span><span class="n">id</span><span class="o">:</span><span class="w"> </span><span class="mi">254</span>
<span class="w">      </span><span class="o">-</span><span class="w"> </span><span class="n">destination</span><span class="o">:</span><span class="w"> </span><span class="mf">10.89</span><span class="o">.</span><span class="mf">136.0</span><span class="o">/</span><span class="mi">24</span>
<span class="w">        </span><span class="n">metric</span><span class="o">:</span><span class="w"> </span><span class="mi">150</span>
<span class="w">        </span><span class="n">next</span><span class="o">-</span><span class="n">hop</span><span class="o">-</span><span class="n">address</span><span class="o">:</span><span class="w"> </span><span class="mf">10.89</span><span class="o">.</span><span class="mf">97.161</span>
<span class="w">        </span><span class="n">next</span><span class="o">-</span><span class="n">hop</span><span class="o">-</span><span class="kd">interface</span><span class="o">:</span><span class="w"> </span><span class="n">vlan104</span>
<span class="w">        </span><span class="n">table</span><span class="o">-</span><span class="n">id</span><span class="o">:</span><span class="w"> </span><span class="mi">254</span>
<span class="w">      </span><span class="o">-</span><span class="w"> </span><span class="n">destination</span><span class="o">:</span><span class="w"> </span><span class="mf">100.64</span><span class="o">.</span><span class="mf">10.3</span><span class="o">/</span><span class="mi">32</span>
<span class="w">        </span><span class="n">metric</span><span class="o">:</span><span class="w"> </span><span class="mi">150</span>
<span class="w">        </span><span class="n">next</span><span class="o">-</span><span class="n">hop</span><span class="o">-</span><span class="n">address</span><span class="o">:</span><span class="w"> </span><span class="mf">10.89</span><span class="o">.</span><span class="mf">97.162</span>
<span class="w">        </span><span class="n">next</span><span class="o">-</span><span class="n">hop</span><span class="o">-</span><span class="kd">interface</span><span class="o">:</span><span class="w"> </span><span class="n">vlan104</span>
<span class="w">        </span><span class="n">table</span><span class="o">-</span><span class="n">id</span><span class="o">:</span><span class="w"> </span><span class="mi">254</span>
<span class="w">      </span><span class="o">-</span><span class="w"> </span><span class="n">destination</span><span class="o">:</span><span class="w"> </span><span class="mf">100.64</span><span class="o">.</span><span class="mf">10.4</span><span class="o">/</span><span class="mi">32</span>
<span class="w">        </span><span class="n">metric</span><span class="o">:</span><span class="w"> </span><span class="mi">150</span>
<span class="w">        </span><span class="n">next</span><span class="o">-</span><span class="n">hop</span><span class="o">-</span><span class="n">address</span><span class="o">:</span><span class="w"> </span><span class="mf">10.89</span><span class="o">.</span><span class="mf">97.163</span>
<span class="w">        </span><span class="n">next</span><span class="o">-</span><span class="n">hop</span><span class="o">-</span><span class="kd">interface</span><span class="o">:</span><span class="w"> </span><span class="n">vlan104</span>
<span class="w">        </span><span class="n">table</span><span class="o">-</span><span class="n">id</span><span class="o">:</span><span class="w"> </span><span class="mi">254</span>
<span class="w">  </span><span class="n">nodeSelector</span><span class="o">:</span>
<span class="w">    </span><span class="n">node</span><span class="o">-</span><span class="n">role</span><span class="o">.</span><span class="na">kubernetes</span><span class="o">.</span><span class="na">io</span><span class="o">/</span><span class="n">gateway</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
</code></pre></div>

<hr />
<h2 id="egress">Egress<a class="headerlink" href="#egress" title="Permanent link">&para;</a></h2>
<p>Egress is needed when application pods communicate with external systems
(e.g., <strong>NetAct</strong>, <strong>SFTP servers</strong>, or <strong>log servers</strong>).</p>
<p>Egress configuration has two components:</p>
<p>1)  <strong>EgressIP configuration</strong> for the application namespace:</p>
<div class="codehilite"><pre><span></span><code>    CWL-Cluster/site-policies/sites/hub/source-crs/egressip/egressip.yaml
</code></pre></div>

<p>2)  <strong>Default egress route configuration</strong> (created via NNCP):</p>
<div class="codehilite"><pre><span></span><code>    CWL-Cluster/site-policies/sites/hub/source-crs/egressip/default_route_for_egress.yaml
</code></pre></div>

<h3 id="egress-explanation">Egress Explanation<a class="headerlink" href="#egress-explanation" title="Permanent link">&para;</a></h3>
<p>1) Application pods send traffic destined for external systems (e.g., NetAct, SFTP).</p>
<p>2) Kubernetes routes this traffic through the EgressIP assigned to the namespace.</p>
<p>3) The egress traffic exits via the GW node where the EgressIP is active.</p>
<p>4) On the GW node, the default egress route (NNCP) ensures that traffic is forwarded to the correct external next-hop. but this default route will be with metric as 999.  which is low priorty for worste case.  so you need to create additional site specific route with metric as 150. </p>
<p>5) From there, the external network routes the traffic to the target system (e.g., NetAct/SFTP server).</p>
<p>6) Return traffic comes back via the same GW node using the EgressIP, maintaining session consistency.</p>
<p>This ensures controlled, predictable outbound traffic from applications to external systems.</p>
<h3 id="egress-diagram">Egress Diagram<a class="headerlink" href="#egress-diagram" title="Permanent link">&para;</a></h3>
<blockquote>
<p>it's just an example:  in our infra, host should be a gateway node and network should be application external network which is metallb bgp network.</p>
</blockquote>
<p><img alt="alt text" src="../image-8.png" /></p>
<h3 id="egress-config-example">Egress Config Example<a class="headerlink" href="#egress-config-example" title="Permanent link">&para;</a></h3>
<h4 id="egress-default-route">Egress default route<a class="headerlink" href="#egress-default-route" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code><span class="n">apiVersion</span><span class="o">:</span><span class="w"> </span><span class="n">nmstate</span><span class="o">.</span><span class="na">io</span><span class="o">/</span><span class="n">v1</span>
<span class="n">kind</span><span class="o">:</span><span class="w"> </span><span class="n">NodeNetworkConfigurationPolicy</span>
<span class="n">metadata</span><span class="o">:</span>
<span class="w">  </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="n">egress</span><span class="o">-</span><span class="k">default</span><span class="o">-</span><span class="n">route</span>
<span class="n">spec</span><span class="o">:</span>
<span class="w">  </span><span class="n">desiredState</span><span class="o">:</span>
<span class="w">    </span><span class="n">routes</span><span class="o">:</span>
<span class="w">      </span><span class="n">config</span><span class="o">:</span>
<span class="w">      </span><span class="o">-</span><span class="w"> </span><span class="n">destination</span><span class="o">:</span><span class="w"> </span><span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">0</span>
<span class="w">        </span><span class="n">metric</span><span class="o">:</span><span class="w"> </span><span class="mi">999</span>
<span class="w">        </span><span class="n">next</span><span class="o">-</span><span class="n">hop</span><span class="o">-</span><span class="n">address</span><span class="o">:</span><span class="w"> </span><span class="mf">10.89</span><span class="o">.</span><span class="mf">97.161</span>
<span class="w">        </span><span class="n">next</span><span class="o">-</span><span class="n">hop</span><span class="o">-</span><span class="kd">interface</span><span class="o">:</span><span class="w"> </span><span class="n">vlan104</span>
<span class="w">        </span><span class="n">table</span><span class="o">-</span><span class="n">id</span><span class="o">:</span><span class="w"> </span><span class="mi">254</span>
<span class="w">      </span><span class="o">-</span><span class="w"> </span><span class="n">destination</span><span class="o">:</span><span class="w"> </span><span class="mf">10.89</span><span class="o">.</span><span class="mf">27.4</span><span class="o">/</span><span class="mi">32</span>
<span class="w">        </span><span class="n">metric</span><span class="o">:</span><span class="w"> </span><span class="mi">150</span>
<span class="w">        </span><span class="n">next</span><span class="o">-</span><span class="n">hop</span><span class="o">-</span><span class="n">address</span><span class="o">:</span><span class="w"> </span><span class="mf">10.89</span><span class="o">.</span><span class="mf">97.161</span>
<span class="w">        </span><span class="n">next</span><span class="o">-</span><span class="n">hop</span><span class="o">-</span><span class="kd">interface</span><span class="o">:</span><span class="w"> </span><span class="n">vlan104</span>
<span class="w">        </span><span class="n">table</span><span class="o">-</span><span class="n">id</span><span class="o">:</span><span class="w"> </span><span class="mi">254</span>
<span class="w">  </span><span class="n">nodeSelector</span><span class="o">:</span>
<span class="w">    </span><span class="n">node</span><span class="o">-</span><span class="n">role</span><span class="o">.</span><span class="na">kubernetes</span><span class="o">.</span><span class="na">io</span><span class="o">/</span><span class="n">gateway</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
</code></pre></div>

<h4 id="egress-ip-configuration">Egress IP configuration<a class="headerlink" href="#egress-ip-configuration" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code><span class="n">apiVersion</span><span class="o">:</span><span class="w"> </span><span class="n">k8s</span><span class="o">.</span><span class="na">ovn</span><span class="o">.</span><span class="na">org</span><span class="o">/</span><span class="n">v1</span>
<span class="n">kind</span><span class="o">:</span><span class="w"> </span><span class="n">EgressIP</span>
<span class="n">metadata</span><span class="o">:</span>
<span class="w">  </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="n">egress</span><span class="o">-</span><span class="n">ncd01pan</span><span class="o">-</span><span class="n">oam</span><span class="o">-</span><span class="n">snat</span>
<span class="n">spec</span><span class="o">:</span>
<span class="w">  </span><span class="n">egressIPs</span><span class="o">:</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="mf">10.89</span><span class="o">.</span><span class="mf">97.172</span>
<span class="w">  </span><span class="n">namespaceSelector</span><span class="o">:</span>
<span class="w">    </span><span class="n">matchLabels</span><span class="o">:</span>
<span class="w">      </span><span class="n">kubernetes</span><span class="o">.</span><span class="na">io</span><span class="o">/</span><span class="n">metadata</span><span class="o">.</span><span class="na">name</span><span class="o">:</span><span class="w"> </span><span class="n">paclypancd01</span>
</code></pre></div>

<hr />
<blockquote>
<p>With these configurations, ingress (backward routes) and egress routes are consistently managed across OCP deployments.</p>
</blockquote>
<h2 id="implementation">Implementation<a class="headerlink" href="#implementation" title="Permanent link">&para;</a></h2>
<blockquote>
<p>below example is showed with label. but you validate your changes accordingly. meaning, if route check route on desired nodes. </p>
</blockquote>
<h2 id="prepare-the-configuration">Prepare the configuration<a class="headerlink" href="#prepare-the-configuration" title="Permanent link">&para;</a></h2>
<ul>
<li>Prepare the config file as described above. </li>
</ul>
<h2 id="push-policy-to-git">Push Policy to Git<a class="headerlink" href="#push-policy-to-git" title="Permanent link">&para;</a></h2>
<p>1)  use the git commands to commitn and push it.</p>
<div class="codehilite"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/ncpcwltri04nac/
git<span class="w"> </span>add<span class="w"> </span>.
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;Adding a labels&quot;</span>
git<span class="w"> </span>push
</code></pre></div>

<hr />
<h2 id="apply-the-policies-now-using-cgu">Apply the policies now using cgu<a class="headerlink" href="#apply-the-policies-now-using-cgu" title="Permanent link">&para;</a></h2>
<p>1)  Verify Policies Rendered</p>
<div class="codehilite"><pre><span></span><code>oc<span class="w"> </span>get<span class="w"> </span>policy<span class="w"> </span>-A<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>label
</code></pre></div>

<p>Example output:</p>
<div class="codehilite"><pre><span></span><code>ztp-policies           ztp-policies.ncpcwltri04nac-labels              inform      NonCompliant   21s
ztp-policies   ncpcwltri04nac-label-nodes                           inform      NonCompliant   21s
</code></pre></div>

<blockquote>
<p><strong>Note</strong>: It might take some time for GitOps to sync with the latest
changes in Git.\
You can expedite this by using the <strong>Refresh</strong> option in the ArgoCD
GUI for the policies app.</p>
</blockquote>
<hr />
<p>2)  Create ClusterGroupUpgrade (CGU)</p>
<p>Before applying the policy, check the current labels of node <code>ncpcwltri04nac</code>:</p>
<div class="codehilite"><pre><span></span><code>oc<span class="w"> </span>get<span class="w"> </span>nodes<span class="w"> </span>--show-labels<span class="w"> </span>--kubeconfig<span class="w"> </span>~/ncpcwltri04nac-kubeconfig
</code></pre></div>

<p>Also check existing CGUs:</p>
<div class="codehilite"><pre><span></span><code>oc<span class="w"> </span>get<span class="w"> </span>cgu<span class="w"> </span>-A
</code></pre></div>

<p>Now, apply the new CGU:</p>
<div class="codehilite"><pre><span></span><code>cat<span class="w"> </span><span class="s">&lt;&lt; EOF | oc apply -f -</span>
<span class="s">apiVersion: ran.openshift.io/v1alpha1</span>
<span class="s">kind: ClusterGroupUpgrade</span>
<span class="s">metadata:</span>
<span class="s">  name: ncpcwltri04nac-labels-config-policies</span>
<span class="s">  namespace: ztp-policies</span>
<span class="s">spec:</span>
<span class="s">  managedPolicies:</span>
<span class="s">  - ncpcwltri04nac-labels-config-policies</span>
<span class="s">  backup: false</span>
<span class="s">  clusters:</span>
<span class="s">  - ncpcwltri04nac</span>
<span class="s">  enable: true</span>
<span class="s">  preCaching: false</span>
<span class="s">  preCachingConfigRef: {}</span>
<span class="s">  remediationStrategy:</span>
<span class="s">    maxConcurrency: 1</span>
<span class="s">    timeout: 240</span>
<span class="s">EOF</span>
</code></pre></div>

<p>Verify the CGU:</p>
<div class="codehilite"><pre><span></span><code>oc<span class="w"> </span>get<span class="w"> </span>cgu<span class="w"> </span>-A<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>ncpcwltri04nac
</code></pre></div>

<hr />
<p>3)  Check Policy Status</p>
<div class="codehilite"><pre><span></span><code>oc<span class="w"> </span>get<span class="w"> </span>policy<span class="w"> </span>-A<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>label
</code></pre></div>

<p>Example output during enforcement:</p>
<div class="codehilite"><pre><span></span><code>ncpcwltri04nac           ztp-policies.ncpcwltri04nac-day2-ncpcwltri04nac-label-nodes-68ffc   enforce     Compliant     13s
ncpcwltri04nac           ztp-policies.ncpcwltri04nac-label-nodes                  inform      NonCompliant  11m
ztp-policies   ncpcwltri04nac-labels-config-policies               enforce     nonCompliant     13s
ztp-policies   ncpcwltri04nac-label-nodes                               inform      NonCompliant  11m
</code></pre></div>

<p>After a few minutes, policies should reach <strong>Compliant</strong> status:</p>
<div class="codehilite"><pre><span></span><code>ncpcwltri04nac           ztp-policies.ncpcwltri04nac-day2-ncpcwltri04nac-label-nodes-68ffc   enforce     Compliant     33s
ncpcwltri04nac           ztp-policies.ncpcwltri04nac-label-nodes                  inform      Compliant     11m
ztp-policies   ncpcwltri04nac-labels-config-policies               inform     Compliant     33s
ztp-policies   ncpcwltri04nac-label-nodes                               inform      Compliant     11m
</code></pre></div>

<hr />
<p>4)  Verify Node Labels</p>
<div class="codehilite"><pre><span></span><code>oc<span class="w"> </span>get<span class="w"> </span>nodes<span class="w"> </span>--show-labels<span class="w"> </span>--kubeconfig<span class="w"> </span>
</code></pre></div>

<p>You should now see the new label applied:</p>
<div class="codehilite"><pre><span></span><code>is_cmm_fds=true
</code></pre></div>

<hr />
<p>5)  CGU Cleanup</p>
<p>After a few minutes, enforced policies will also be deleted.\
Check CGU status after successful compliance:</p>
<div class="codehilite"><pre><span></span><code>oc<span class="w"> </span>get<span class="w"> </span>cgu<span class="w"> </span>-A<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>label
</code></pre></div>

<p>Example:</p>
<div class="codehilite"><pre><span></span><code>ztp-policies   ncpcwltri04nac-labels    40m   Completed   All clusters are compliant with all the managed policies
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../../../js/auth.js"></script>
      
    
  </body>
</html>